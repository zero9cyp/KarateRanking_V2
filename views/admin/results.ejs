<h1>Manage Results (Admin Only)</h1>

<form id="bulkDeleteForm" action="/admin/results/delete-selected" method="POST" onsubmit="return confirm('Delete selected results?');">
  <button type="submit" class="btn btn-danger mb-3">Delete Selected Results</button>

  <% if (results.length === 0) { %>
    <p>No results found.</p>
  <% } else { %>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th><input type="checkbox" id="selectAll"></th>
          <th>Athlete</th>
          <th>Club</th>
          <th>Age</th>
          <th>Weight</th>
          <th>Tournament</th>
          <th>Placement</th>
          <th>Wins</th>
          <th>Points</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% results.forEach(r => { %>
          <tr>
            <td><input type="checkbox" name="selected[]" value="<%= r.result_id %>"></td>
            <td><%= r.full_name %></td>
            <td><%= r.club_name || 'N/A' %></td>
            <td><%= r.age_category %></td>
            <td><%= r.weight_category %></td>
            <td><%= r.tournament || 'N/A' %></td>
            <td><%= r.placement %></td>
            <td><%= r.wins %></td>
            <td><%= r.points_earned %></td>
            <td>
              <form action="/admin/results/delete/<%= r.result_id %>" method="POST" style="display:inline;">
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Delete this result?')">Delete</button>
              </form>
              <a href="/admin/results/edit/<%= r.result_id %>" class="btn btn-primary btn-sm">Edit</a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</form>

<script>
  // Select/Deselect all checkboxes
  document.getElementById('selectAll').addEventListener('change', function() {
    const checkboxes = document.querySelectorAll('input[name="selected[]"]');
    checkboxes.forEach(cb => cb.checked = this.checked);
  });
</script>
